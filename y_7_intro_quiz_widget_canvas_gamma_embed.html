<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Year 7 English – Intro Quiz</title>
  <!-- Tailwind via CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Chart.js for results chart -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="min-h-screen bg-gradient-to-br from-pink-200 via-purple-200 to-blue-200 flex items-center justify-center p-4">
  <main class="w-full max-w-3xl bg-white/90 backdrop-blur rounded-2xl shadow-xl p-6 sm:p-8">
    <header class="mb-6">
      <h1 class="text-2xl sm:text-3xl font-bold tracking-tight">Year 7 English – Course Intro Quiz</h1>
      <p class="text-sm text-gray-700 mt-1">Quick check on how our course works (Canvas marks, practice, live lessons). 5 questions. Instant feedback. Earn up to 5 points.</p>
    </header>

    <!-- Progress -->
    <div class="mb-4">
      <div class="flex justify-between text-sm font-medium">
        <span id="progressLabel">Question 1 of 5</span>
        <span id="scoreLabel">Score: 0</span>
      </div>
      <div class="w-full bg-gray-200 rounded-full h-2 mt-2">
        <div id="progressBar" class="bg-indigo-500 h-2 rounded-full transition-all" style="width: 0%"></div>
      </div>
    </div>

    <!-- Quiz Card -->
    <section id="card" class="bg-white rounded-xl border border-gray-200 shadow-sm p-5">
      <h2 id="question" class="text-lg font-semibold">Loading…</h2>
      <div id="options" class="mt-4 grid gap-3"></div>
      <div id="feedback" class="mt-3 text-sm font-medium"></div>
      <div class="mt-5 flex items-center gap-3">
        <button id="nextBtn" class="px-4 py-2 rounded-xl bg-indigo-600 text-white font-semibold disabled:opacity-40">Next</button>
        <button id="restartBtn" class="px-4 py-2 rounded-xl bg-gray-100 text-gray-900 font-semibold hidden">Restart</button>
      </div>
    </section>

    <!-- Results -->
    <section id="results" class="hidden mt-6 bg-white rounded-xl border border-gray-200 shadow-sm p-5">
      <h3 class="text-xl font-bold">Results</h3>
      <p id="summary" class="mt-1 text-gray-700"></p>
      <canvas id="chart" class="mt-4" height="160"></canvas>
      <div class="mt-5 space-y-2">
        <details class="bg-green-50 border border-green-200 rounded-lg p-3">
          <summary class="font-semibold text-green-900">What to remember</summary>
          <ul class="list-disc ml-6 mt-2 text-green-900 text-sm">
            <li>Canvas assignments, quizzes and tests count for marks.</li>
            <li>Practice tasks build fluency and do not count for marks.</li>
            <li>Live lessons focus on skill-building linked to assessments.</li>
          </ul>
        </details>
        <button id="retryBtn" class="px-4 py-2 rounded-xl bg-indigo-600 text-white font-semibold">Try Again</button>
      </div>
    </section>

    <!-- Footer Help -->
    <footer class="mt-6 text-xs text-gray-600">
      <p>Tip: Press <kbd class="border px-1 rounded">N</kbd> for Next.</p>
    </footer>
  </main>

  <script>
    const QUESTIONS = [
      {
        q: "Where are graded tasks submitted?",
        options: ["Email to teacher", "Canvas assignments/quizzes", "Chat during the live lesson", "Google Docs only"],
        answer: 1,
        explain: "All graded work is submitted on Canvas (assignments, quizzes, tests)."
      },
      {
        q: "What is the purpose of practice tasks?",
        options: ["Extra marks", "Fluency and skill-building", "Punishment", "They replace assessments"],
        answer: 1,
        explain: "Practice tasks are for fluency and improvement; they are not graded."
      },
      {
        q: "What do live lessons focus on?",
        options: ["Watching movies", "Free chat only", "Skill-building linked to assessments", "Admin only"],
        answer: 2,
        explain: "Live lessons target skills that map to assessment objectives."
      },
      {
        q: "If you miss a Canvas due date, what might happen?",
        options: ["Nothing", "Automatic full marks", "You may receive no mark or late penalty", "It becomes a practice task"],
        answer: 2,
        explain: "Canvas deadlines matter. Late or missing work may receive no mark or a penalty per policy."
      },
      {
        q: "Which statement is true?",
        options: ["Practice = marks", "Canvas = marks", "Live lessons = grades only", "Group chat = marks"],
        answer: 1,
        explain: "Canvas is where marks are recorded; practice is ungraded."
      }
    ];

    const state = { idx: 0, score: 0, answered: false, selections: [], correctLog: [] };

    const els = {
      q: document.getElementById('question'),
      options: document.getElementById('options'),
      feedback: document.getElementById('feedback'),
      next: document.getElementById('nextBtn'),
      restart: document.getElementById('restartBtn'),
      retry: document.getElementById('retryBtn'),
      results: document.getElementById('results'),
      card: document.getElementById('card'),
      progressBar: document.getElementById('progressBar'),
      progressLabel: document.getElementById('progressLabel'),
      scoreLabel: document.getElementById('scoreLabel'),
      summary: document.getElementById('summary'),
      chart: document.getElementById('chart')
    };

    function render() {
      const total = QUESTIONS.length;
      const qObj = QUESTIONS[state.idx];
      els.q.textContent = qObj.q;
      els.options.innerHTML = '';
      els.feedback.textContent = '';
      els.next.disabled = true;
      els.progressLabel.textContent = `Question ${state.idx + 1} of ${total}`;
      els.progressBar.style.width = `${((state.idx) / total) * 100}%`;
      els.scoreLabel.textContent = `Score: ${state.score}`;
      state.answered = false;

      qObj.options.forEach((opt, i) => {
        const btn = document.createElement('button');
        btn.className = 'w-full text-left px-4 py-3 rounded-xl border border-gray-200 hover:border-indigo-400 hover:bg-indigo-50 focus:outline-none focus:ring-2 focus:ring-indigo-300';
        btn.innerHTML = `<span class="font-medium">${String.fromCharCode(65 + i)}.</span> ${opt}`;
        btn.addEventListener('click', () => select(i));
        els.options.appendChild(btn);
      });
    }

    function select(i) {
      if (state.answered) return;
      const qObj = QUESTIONS[state.idx];
      const correct = i === qObj.answer;
      state.answered = true;
      state.selections[state.idx] = i;
      state.correctLog[state.idx] = correct;
      if (correct) state.score++;

      Array.from(els.options.children).forEach((btn, idx) => {
        btn.classList.remove('border-gray-200');
        if (idx === qObj.answer) btn.classList.add('border-green-500','bg-green-50');
        if (idx === i && !correct) btn.classList.add('border-red-500','bg-red-50');
        btn.disabled = true;
      });
      els.feedback.textContent = (correct ? 'Correct. ' : 'Not quite. ') + qObj.explain;
      els.next.disabled = false;
      els.progressBar.style.width = `${((state.idx + 1) / QUESTIONS.length) * 100}%`;
      els.scoreLabel.textContent = `Score: ${state.score}`;
    }

    function next() {
      if (!state.answered) return;
      if (state.idx < QUESTIONS.length - 1) {
        state.idx++;
        render();
      } else {
        showResults();
      }
    }

    function showResults() {
      els.card.classList.add('hidden');
      els.results.classList.remove('hidden');
      els.progressLabel.textContent = 'Completed';
      els.progressBar.style.width = '100%';
      els.scoreLabel.textContent = `Score: ${state.score}`;
      els.summary.textContent = `You scored ${state.score} / ${QUESTIONS.length}.`;

      const ctx = els.chart.getContext('2d');
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: QUESTIONS.map((_, i) => `Q${i+1}`),
          datasets: [{
            label: 'Correct (1) / Incorrect (0)',
            data: state.correctLog.map(v => v ? 1 : 0)
          }]
        },
        options: {
          responsive: true,
          plugins: { legend: { display: false } },
          scales: { y: { beginAtZero: true, ticks: { stepSize: 1, precision: 0 }, suggestedMax: 1 } }
        }
      });
    }

    function restart() {
      state.idx = 0; state.score = 0; state.answered = false; state.selections = []; state.correctLog = [];
      els.results.classList.add('hidden');
      els.card.classList.remove('hidden');
      render();
    }

    // Events
    els.next.addEventListener('click', next);
    document.addEventListener('keydown', (e) => { if (e.key.toLowerCase() === 'n') next(); });
    document.getElementById('retryBtn').addEventListener('click', restart);
    document.getElementById('restartBtn').addEventListener('click', restart);

    // Init
    render();
  </script>
</body>
</html>
